
# Расчет управленческой зарплаты

На предприятии работают сотрудники двух категорий: специалисты и административный персонал. Специалистам начисляется минимальный оклад и процент за выполненные работы клиентам. Административный персонал получает оклад. Любому сотруднику на усмотрение руководства может быть начислена разовая фиксированная премия.
Сотрудники могут уходить в отпуск, в период отпуска оклад не начисляется, отпускные рассчитываются как средневной заработок за последние 12 месяцев (начисленная за это время сумма, деленная на количество рабочих дней) х Количество календарных дней отпуска.
С каждого сотрудника удерживается НДФЛ 13%.
Для упрощения примем, что выплаты осуществляются один раз в месяц после начисления зарплаты.
Кроме этого на предприятии планируются отпуска на год вперед.

## Расчет зарплаты

Для каждого сотрудника необходимо хранить суммы окладов. Дополнительно для специалистов необходимо хранить процент от выполнгенных заказов, который им будет начисляться. Расчет зарплаты выполняется документом НачислениеЗаработнойПлаты по всем видам расчета, кроме премий. Премии начисляются отдельным документом НачислениеФиксированныхПремий.
Документы НачислениеЗаработнойПлаты и НачислениеФиксированныхПремий при расчете должны автоматически рассчитывать удержание НДФЛ.

Для решения задачи:
1. Добавим планы видов расчета ОсновныеНачисления, ДополнительныеНачисления и Удержания, настроим их с учетом описанного сценария начислений
2. Создадим регистры расчета ОсновныеНачисления, ДополнительныеНачисления и Удержания
3. Создадим регистр сведений УсловияОплатыСотрудников с периодичностью Месяц, измерением Сотрудник и ресурсами Оклад и ПроцентОтРабот
4. Создадим регистр накопления ВыполненныеСотрудникомРаботы с измерением Сотрудник, ресурсами ЧасовКОплате и СуммаКОплате
5. Реализуем в документе ОбслуживаниеКлиента алгоритм для формирования движений по регистру ВыполненныеСотрудникомРаботы
    - Если на дату документа специалисту не установлен процент оплаты от работ, то документ не должен проводится. Необходимо учитывать, что может быть установлен нулевой процент, в этом случае документ должен проводится
    - СуммаКОплате рассчитывается как ЧасовКОплатеКлиенту * СтавкаЧасаКлиента * ПроцентОтРабот / 100
6. Создадим документ НачисленияЗарплаты и реализуем алгоритм расчета в соответствии с требованиями к механизмам сложных периодических расчетов для экзамена 1С:Специалист по платформе
7. Создадим документ НачислениеФиксированнойПремии с табличной частью СписокСотрудников (Сотрудник, СуммаПремии), реализуем запись премии в регистр при проведении и расчет НДФЛ

## Выплата зарплаты

Необхдоимо учитывать какая сумма начислена и какая сумма выплачена сотрудникам.

Для решения задачи:
1. Создадим регистр накопления ВзаиморасчетыССотрудниками с измерением Сотрудник и ресурсов Сумма
2. Для документов НачислениеЗарплаты и НачислениеФиксированнойПремии реализуем алгоритм формирования движений по регистру ВзаиморасчетыССотрудниками. Сумма должна расчитываться как `ОсновныеНачисления + ДополнительныеНачисления - Удержания`, зарегистрированные этим документов.
3. Создадим документ ВыплатаЗарплаты:
    - С табличной частью Выплатны (Сотрудник, Сумма)
    - С механизмом автозаполнения по остаткам регистра ВзаиморасчетыССотрудниками на дату документа
4. Реализуем механизм проведения документа с формирование движений по регистру ВзаиморасчетыССотрудниками

## Планирование отпусков

В начале года на предприятии составляется график отпусков. Необходимо возможность визуального контроля, что все сотрудники одновременно не уйдут в отпуск. 

Для решения задачи:
1. Создадим документ ГрафикОтпусков с реквизитом Год и табличной часть ОтпускаСотрудников (Сотрудник, ДатаНачала, ДатаОкончания)
2. Создадим форму документа, на форме реализуем подсветку строк сотрудников, общая длительность отпуска которых более 28 календарных дней
3. Создадим дополнительную форму документа АнализГрафика, добавим команду на открытие дополнительной формы на основную форму документа
4. На форме АнализГрафика отобразим диаграмму ганта с запланированными отпусками сотрудников текущим документом в выбранном году. Данные из основной формы в дополнительную форму для построения диаграммы ганта передаем через временной хранилище.

## Права доступа

Вводом информации о заработной плате, плановых отпусках занимаются Кадровики-расчетчики

Для решения задачи:
1. Создадим необходимые роли для работы с объектами
2. Добавим поставляемый профиль групп доступа КадровикРасчетчик
3. Добавим в профиль роли